import{Q as _,a as T}from"./QBreadcrumbs.e2923fe3.js";import{_ as j,k as E,aP as L,bf as U,r as c,o as z,n as l,A as b,q as t,u as o,j as e,aD as v,z as F,K as M,p as P,v as R,F as w,D as N,J as O,bg as G}from"./index.402e5cb0.js";import{Q as I}from"./QExpansionItem.93e2156c.js";import{Q as J}from"./QList.2b113048.js";import{Q as K}from"./QPage.fbc5bef6.js";import{u as H}from"./useUsers.3dcbe72b.js";import{u as W}from"./usePermisos.71de3d00.js";import{u as X}from"./use-quasar.12cbe038.js";import"./QItem.da63a453.js";const Y=E({name:"asignarRolesPage",setup(){H();const a=W(),i=X(),h=L(),d=U(),{role:u,modulos:k,permisos:r,getRoles:q,getModules:n,getRole:m,getPermissions:p,addPermissionsToRole:$}=a,x=c(""),B=c([{name:"role",label:"Role",field:"role",align:"center"},{name:"description",label:"Descripci\xF3n",field:"description",align:"center"},{name:"usuarios",label:"Usuarios",field:"usuarios",align:"center"},{name:"acciones",label:"Acciones",align:"center"}]),g=c([]),Q=c([]),y=(s,f)=>{i.notify({position:"top",type:f,message:s})},C=s=>{h.push({name:"assign",params:{id:s.id}})},A=s=>r.value.filter(D=>D.module_id===s.id),S=async()=>{await p(),r.value.map(s=>{Q.value.push({text:s.name,value:s.id,module_id:s.module_id})})},V=()=>{i.dialog({title:"\xBFSeguro que quieres continuar?",message:"Se asignaran los permisos seleccionados",ok:{push:!0,label:"Guardar"},cancel:{push:!0,color:"dark",label:"Cancelar"},persistent:!0}).onOk(async s=>{(await $({role_id:d.params.id,permissions_ids:g.value})).status==200?y("Se actualiz\xF3 el rol exitosamente","positive"):y("Por favor contacta al administrador","negative")})};return z(async()=>{await m(d.params.id),await n(),await S(),setTimeout(function(){Object.values(u.value.permissions).map(function(s){g.value.push(s.id)})},500)}),{columns:B,filter:x,role:u,modulos:k,permisos:r,permisosAsignar:g,permissionsList:Q,assignar:V,goTo:C,listaPermisos:A}}}),Z={class:"q-pa-md q-gutter-sm"},ss={class:"row q-mt-lg"},es={class:"col-xs-12"},as={class:"q-pa-sm"},os={class:"text-h5"},rs={class:"row q-pa-sm q-mt-md"},ts={class:"q-gutter-sm"},is={class:"row justify-end q-pa-md"};function ls(a,i,h,d,u,k){return l(),b(K,{class:"q-pa-sm"},{default:t(()=>[o("div",Z,[e(T,null,{default:t(()=>[e(_,{icon:"home",to:{name:"index-admin"}}),e(_,{label:"Roles",icon:"bookmark",to:{name:"roles"}}),e(_,{label:"Role",icon:"check_circle"})]),_:1})]),o("div",ss,[o("div",es,[o("div",as,[e(O,{rounded:"",class:"q-pa-md"},{default:t(()=>[e(v),o("span",os,"Role:"+F(a.role.name),1),e(v),e(M,{class:"q-mt-md"},{default:t(()=>[e(J,{bordered:"",class:"rounded-borders"},{default:t(()=>[(l(!0),P(w,null,R(a.modulos,(r,q)=>(l(),b(I,{"expand-separator":"",icon:"bookmark","header-class":"text-primary",label:`${r.name}`,key:q,style:{border:".2px solid gray"}},{default:t(()=>[e(v),o("div",rs,[o("div",ts,[(l(!0),P(w,null,R(a.listaPermisos(r),(n,m)=>(l(),b(G,{key:m,color:"primary",label:`${n.name}`,modelValue:a.permisosAsignar,"onUpdate:modelValue":i[0]||(i[0]=p=>a.permisosAsignar=p),val:n.id},null,8,["label","modelValue","val"]))),128))])])]),_:2},1032,["label"]))),128))]),_:1})]),_:1}),o("div",is,[e(N,{label:"guardar",color:"primary",onClick:a.assignar},null,8,["onClick"])])]),_:1})])])])]),_:1})}var bs=j(Y,[["render",ls]]);export{bs as default};
