import{Q as m,a as S}from"./QBreadcrumbs.e2923fe3.js";import{_ as z,k as V,bf as C,a as B,r as y,w as $,o as A,n as p,A as h,q as r,u as e,j as a,K as x,al as E,z as v,Q as b,y as T,s as j,bg as w,D as U,aD as N,p as P,v as F,F as I,J as O}from"./index.402e5cb0.js";import{Q as G}from"./QPage.fbc5bef6.js";import{u as J}from"./useUsers.3dcbe72b.js";import{u as K}from"./usePermisos.71de3d00.js";import{u as L}from"./use-quasar.12cbe038.js";const M=V({name:"editarUsuarioPage",setup(){const s=L(),o=C(),{fetchUser:_,setStatusUser:f,user_edit:g,AppActiveUser:q}=J(),{getRoles:l,roles:d,addRolesToUser:Q}=K(),i=B(()=>g.value),u=y(!0),n=y([]),k=async()=>{n.value;const t=await Q({user_id:o.params.id,roles_ids:n.value});if(t.status==200)s.notify({position:"top",type:"positive",message:"Se actualizaron los roles del usuario"}),q.value.id===o.params.id&&window.location.replace(`${location.href}`);else{const c=t.response.data.message;s.notify({position:"top",type:"negative",message:c})}},R=()=>{s.dialog({title:"\xBFSeguro que quieres continuar?",message:"Se actualizar\xE1n los roles seleccionados",cancel:{label:"cancelar",color:"dark"},persistent:!0,ok:{label:"Aceptar",color:"primary"}}).onOk(()=>{k()}).onOk(()=>{}).onCancel(()=>{}).onDismiss(()=>{})};return $(u,async t=>{const c=t===!1?"inactiv\xF3":"activ\xF3",D={id:i.value.id,status:t};await f(D),s.notify({position:"top",type:"positive",message:`Se ${c} al usuario`})}),A(async()=>{await _(o.params.id),await l(),u.value=i.value.active==1,i.value.roles.forEach(t=>{n.value.push(t.id)})}),{userData:i,statusUser:u,roles:d,selectedRoles:n,confirmRoles:R}}}),H={class:"q-pa-md q-gutter-sm"},W={class:"row justify-betweem"},X={class:"bg-grey-2 square-box text-center col-xs-12 col-md-3 col-sm-4"},Y=["src"],Z={class:"text-dark q-mt-md text-weight-bold"},ss={class:"col-xs-12 col-sm-7 text-grey-7 q-ma-md"},es={class:"q-pl-sm q-mt-md"},as={class:"q-pl-sm q-mt-md"},os={class:"q-pl-sm q-mt-md"},ts={class:"q-pl-md q-mt-md"},ls={class:"q-mt-md"},rs=e("div",{class:"row"},[e("p",{class:"row text-h4"},"Roles")],-1),is={class:"row q-mt-md justify-end"};function ns(s,o,_,f,g,q){return p(),h(G,{class:"q-pa-lg"},{default:r(()=>[e("div",H,[a(S,null,{default:r(()=>[a(m,{icon:"home",to:{name:"index-admin"}}),a(m,{label:"Usuarios",icon:"group",to:{name:"usuarios"}}),a(m,{label:"Usuario",icon:"person"})]),_:1})]),a(O,{rounded:""},{default:r(()=>[a(x,null,{default:r(()=>[e("div",W,[e("div",X,[a(E,{size:"120px"},{default:r(()=>[e("img",{src:s.userData.avatar},null,8,Y)]),_:1}),e("p",Z,v(s.userData.name),1)]),e("div",ss,[e("div",es,[a(b,{name:"mail",size:"md"}),T(" "+v(s.userData.email),1)]),e("div",as,[a(b,{name:"bookmark",size:"md"}),e("span",{class:j({"text-red":s.userData.role==null})},v(s.userData.role!=null?s.userData.role:"Sin role asignado"),3)]),e("div",os,[a(w,{modelValue:s.statusUser,"onUpdate:modelValue":o[0]||(o[0]=l=>s.statusUser=l),val:"calories",label:"Inactivo / Activo"},null,8,["modelValue"])]),e("div",ts,[a(U,{size:"md",color:"primary",label:"Reset password"})])])]),e("div",ls,[rs,a(N,{spaced:""}),(p(!0),P(I,null,F(s.roles,l=>(p(),h(w,{modelValue:s.selectedRoles,"onUpdate:modelValue":o[1]||(o[1]=d=>s.selectedRoles=d),val:l.id,label:l.role},null,8,["modelValue","val","label"]))),256))]),e("div",is,[a(U,{size:"md",color:"primary",label:"Guardar",onClick:s.confirmRoles},null,8,["onClick"])])]),_:1})]),_:1})]),_:1})}var _s=z(M,[["render",ns]]);export{_s as default};
