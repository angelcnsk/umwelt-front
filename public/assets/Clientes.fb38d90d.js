import{Q as $}from"./QTooltip.f2d4a764.js";import{_ as B,k as D,aP as N,r,a as I,w as E,o as F,n as b,A as y,q as l,u as t,D as g,j as a,y as C,x as z,L as d,Q as S,z as _,J as V,K as j,bm as x,ah as G,b6 as J}from"./index.32e23850.js";import{Q}from"./QSelect.1c1fbcf0.js";import{Q as K,a as h}from"./QTable.a082a620.js";import{Q as L}from"./QPage.73906722.js";import{C as M}from"./ClosePopup.62cdd944.js";import{u as O}from"./useClientes.6d1579ec.js";import{u as H}from"./useUsers.57a4c951.js";import{u as W}from"./use-quasar.20dc04b9.js";import"./position-engine.ca5b71d8.js";import"./QItem.842ffa8b.js";import"./format.a0c35f62.js";import"./QList.6cb04e67.js";import"./QMarkupTable.b9a710fd.js";const X=D({name:"clientesPage",setup(){const s=O(),o=H(),c=W(),w=N(),{AppActiveUser:i}=o,{getClients:u,clients:e,createClient:q}=s,m=r(!1),p=r({}),v=r(!1),k=r(""),U=r([{name:"id",label:"Id",field:"id",align:"center"},{name:"legalname",label:"Nombre",field:"legalname",align:"center",sortable:!0,sortOrder:"ad"},{name:"rfc",label:"RFC",field:"rfc",align:"center"},{name:"status",label:"Estatus",field:"status",align:"center"}]),R=I(async()=>i.value.permissions);E(R,async n=>{const f=await n;m.value=f.find(T=>T==="agregar_empresa")});const A=(n,f)=>{w.push({name:"cliente",params:{id:f.id}})},P=async()=>{const n=await q(p.value);n.response&&n.response.data.errors&&c.notify({position:"top",type:"negative",message:"El RFC ingresado corresponde a otro cliente"}),n.status==200&&(c.notify({position:"top",type:"positive",message:"El cliente se cre\xF3 correctamente"}),u(),v.value=!1,p.value={})};return F(async()=>{i.value.permissions&&(m.value=i.value.permissions.find(n=>n==="agregar_empresa")),await u()}),{agregar_cliente:m,clients:e,columns:U,filter:k,addClient:v,newClient:p,goTo:A,saveClient:P}}}),Y={class:"row q-pa-sm"},Z={class:"col-md-12"},ee={class:"row q-mt-lg"},se={class:"col-xs-12"},ae={class:"q-pa-sm"},le={class:"q-mb-lg"},oe={class:"col-xs-11 col-sm-4 q-pa-sm"},te={class:"col-xs-11 col-sm-4 q-pa-sm"},ne={class:"col-xs-11 col-sm-4 q-pa-sm"};function re(s,o,c,w,i,u){return b(),y(L,{class:"q-pa-sm"},{default:l(()=>[t("div",Y,[t("div",Z,[s.agregar_cliente?(b(),y(g,{key:0,onClick:o[0]||(o[0]=e=>s.addClient=!0),color:"primary",glossy:"","text-color":"white",icon:"domain_add"},{default:l(()=>[a($,{anchor:"center right",self:"center left",offset:[10,10]},{default:l(()=>[C(" Agregar cliente ")]),_:1})]),_:1})):z("",!0)])]),t("div",ee,[t("div",se,[t("div",ae,[a(V,{rounded:""},{default:l(()=>[a(K,{title:"Clientes",rows:s.clients,columns:s.columns,filter:s.filter,"row-key":"id",onRowClick:s.goTo},{"top-right":l(()=>[a(d,{borderless:"",dense:"",debounce:"300",modelValue:s.filter,"onUpdate:modelValue":o[1]||(o[1]=e=>s.filter=e),placeholder:"Buscar"},{append:l(()=>[a(S,{name:"search"})]),_:1},8,["modelValue"])]),"body-cell-client_id":l(e=>[a(h,{props:e,class:"text-center"},{default:l(()=>[a(Q,{outline:"",square:"",color:"primary","text-color":"white",class:"text-center"},{default:l(()=>[C(_(e.row.active==null?"Principal":"Planta"),1)]),_:2},1024)]),_:2},1032,["props"])]),"body-cell-status":l(e=>[a(h,{props:e,class:"text-center"},{default:l(()=>[a(Q,{outline:"",square:"",color:e.row.status?"primary":"grey","text-color":"white",class:"text-center"},{default:l(()=>[C(_(e.row.status?"Activo":"Inactivo"),1)]),_:2},1032,["color"])]),_:2},1032,["props"])]),_:1},8,["rows","columns","filter","onRowClick"])]),_:1})])])]),a(J,{modelValue:s.addClient,"onUpdate:modelValue":o[5]||(o[5]=e=>s.addClient=e),ref:"address","transition-show":"flip-down","transition-hide":"flip-up"},{default:l(()=>[a(V,{class:"q-dialog-plugin"},{default:l(()=>[a(j,null,{default:l(()=>[t("div",le,[t("div",oe,[a(d,{modelValue:s.newClient.legalname,"onUpdate:modelValue":o[2]||(o[2]=e=>s.newClient.legalname=e),label:"Raz\xF3n social"},null,8,["modelValue"])]),t("div",te,[a(d,{modelValue:s.newClient.rfc,"onUpdate:modelValue":o[3]||(o[3]=e=>s.newClient.rfc=e),maxlength:"13",rules:[e=>!!e||"* Campo obligatorio"],label:"RFC"},null,8,["modelValue","rules"])]),t("div",ne,[a(d,{modelValue:s.newClient.business_description,"onUpdate:modelValue":o[4]||(o[4]=e=>s.newClient.business_description=e),label:"Descripci\xF3n giro comercial"},null,8,["modelValue"])])])]),_:1}),a(x,{align:"right"},{default:l(()=>[G(a(g,{color:"primary",label:"Cancelar"},null,512),[[M]]),a(g,{color:"primary",label:"Guardar",onClick:s.saveClient},null,8,["onClick"])]),_:1})]),_:1})]),_:1},8,["modelValue"])]),_:1})}var Ve=B(X,[["render",re]]);export{Ve as default};
