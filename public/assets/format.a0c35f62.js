import{E as ne,ac as ue,G as se,am as le,ad as ie,r as M,a as c,H as re,an as ce,ae as fe,ao as de,af as ve,ap as ge,w as A,aq as he,ar as me,as as Pe,at as D,a1 as Te,au as ye,h as R,I as Se,av as ke,m as xe,g as Ce,aw as Be,W as qe,ax as Oe,U as be}from"./index.32e23850.js";import{u as we,v as H,a as Ee,b as Fe,c as Me,p as K,r as z,s as Ae,d as De}from"./position-engine.ca5b71d8.js";var Ke=ne({name:"QMenu",inheritAttrs:!1,props:{...we,...ue,...se,...le,persistent:Boolean,autoClose:Boolean,separateClosePopup:Boolean,noRouteDismiss:Boolean,noRefocus:Boolean,noFocus:Boolean,fit:Boolean,cover:Boolean,square:Boolean,anchor:{type:String,validator:H},self:{type:String,validator:H},offset:{type:Array,validator:Ee},scrollTarget:{default:void 0},touchPosition:Boolean,maxHeight:{type:String,default:null},maxWidth:{type:String,default:null}},emits:[...ie,"click","escapeKey"],setup(e,{slots:o,emit:a,attrs:u}){let n=null,v,f,g;const S=Ce(),{proxy:h}=S,{$q:s}=h,l=M(null),i=M(!1),W=c(()=>e.persistent!==!0&&e.noRouteDismiss!==!0),Q=re(e,s),{registerTick:U,removeTick:$}=ce(),{registerTimeout:k}=fe(),{transitionProps:j,transitionStyle:G}=de(e),{localScrollTarget:x,changeScrollEvent:_,unconfigureScrollTarget:L}=Fe(e,E),{anchorEl:r,canShow:J}=Me({showing:i}),{hide:C}=ve({showing:i,canShow:J,handleShow:Z,handleHide:p,hideOnRouteChange:W,processOnMount:!0}),{showPortal:B,hidePortal:q,renderPortal:N}=ge(S,l,te,"menu"),m={anchorEl:r,innerRef:l,onClickOutside(t){if(e.persistent!==!0&&i.value===!0)return C(t),(t.type==="touchstart"||t.target.classList.contains("q-dialog__backdrop"))&&be(t),!0}},O=c(()=>K(e.anchor||(e.cover===!0?"center middle":"bottom start"),s.lang.rtl)),V=c(()=>e.cover===!0?O.value:K(e.self||"top start",s.lang.rtl)),X=c(()=>(e.square===!0?" q-menu--square":"")+(Q.value===!0?" q-menu--dark q-dark":"")),Y=c(()=>e.autoClose===!0?{onClick:ee}:{}),b=c(()=>i.value===!0&&e.persistent!==!0);A(b,t=>{t===!0?(Be(T),De(m)):(D(T),z(m))});function P(){qe(()=>{let t=l.value;t&&t.contains(document.activeElement)!==!0&&(t=t.querySelector("[autofocus][tabindex], [data-autofocus][tabindex]")||t.querySelector("[autofocus] [tabindex], [data-autofocus] [tabindex]")||t.querySelector("[autofocus], [data-autofocus]")||t,t.focus({preventScroll:!0}))})}function Z(t){if(n=e.noRefocus===!1?document.activeElement:null,he(F),B(),E(),v=void 0,t!==void 0&&(e.touchPosition||e.contextMenu)){const y=me(t);if(y.left!==void 0){const{top:oe,left:ae}=r.value.getBoundingClientRect();v={left:y.left-ae,top:y.top-oe}}}f===void 0&&(f=A(()=>s.screen.width+"|"+s.screen.height+"|"+e.self+"|"+e.anchor+"|"+s.lang.rtl,d)),e.noFocus!==!0&&document.activeElement.blur(),U(()=>{d(),e.noFocus!==!0&&P()}),k(()=>{s.platform.is.ios===!0&&(g=e.autoClose,l.value.click()),d(),B(!0),a("show",t)},e.transitionDuration)}function p(t){$(),q(),w(!0),n!==null&&(t===void 0||t.qClickOutside!==!0)&&(((t&&t.type.indexOf("key")===0?n.closest('[tabindex]:not([tabindex^="-"])'):void 0)||n).focus(),n=null),k(()=>{q(!0),a("hide",t)},e.transitionDuration)}function w(t){v=void 0,f!==void 0&&(f(),f=void 0),(t===!0||i.value===!0)&&(Pe(F),L(),z(m),D(T)),t!==!0&&(n=null)}function E(){(r.value!==null||e.scrollTarget!==void 0)&&(x.value=Te(r.value,e.scrollTarget),_(x.value,d))}function ee(t){g!==!0?(ye(h,t),a("click",t)):g=!1}function F(t){b.value===!0&&e.noFocus!==!0&&Oe(l.value,t.target)!==!0&&P()}function T(t){a("escapeKey"),C(t)}function d(){const t=l.value;t===null||r.value===null||Ae({el:t,offset:e.offset,anchorEl:r.value,anchorOrigin:O.value,selfOrigin:V.value,absoluteOffset:v,fit:e.fit,cover:e.cover,maxHeight:e.maxHeight,maxWidth:e.maxWidth})}function te(){return R(ke,j.value,()=>i.value===!0?R("div",{role:"menu",...u,ref:l,tabindex:-1,class:["q-menu q-position-engine scroll"+X.value,u.class],style:[u.style,G.value],...Y.value},Se(o.default)):null)}return xe(w),Object.assign(h,{focus:P,updatePosition:d}),N}});const I=["B","KB","MB","GB","TB","PB"];function ze(e){let o=0;for(;parseInt(e,10)>=1024&&o<I.length-1;)e/=1024,++o;return`${e.toFixed(1)}${I[o]}`}function Ie(e){return e.charAt(0).toUpperCase()+e.slice(1)}function We(e,o,a){return a<=o?o:Math.min(a,Math.max(o,e))}function Qe(e,o,a){if(a<=o)return o;const u=a-o+1;let n=o+(e-o)%u;return n<o&&(n=u+n),n===0?0:n}function Ue(e,o=2,a="0"){if(e==null)return e;const u=""+e;return u.length>=o?u:new Array(o-u.length+1).join(a)+u}export{Ke as Q,We as b,Ie as c,ze as h,Qe as n,Ue as p};
